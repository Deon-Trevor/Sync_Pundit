<!DOCTYPE html><html lang="en-gb"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><title>Vulnversity - Walkthrough, Sync_Pundit&#x27;s Blog👽😎🔱🔥</title><meta name="description" content="Vulnversity - Walkthrough. Step by step guide on how to exploit Vulnversity on https://tryhackme.com/room/vulnversity"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://blog.syncpundit.ml/vulnversity-walkthrough/"><link rel="amphtml" href="https://blog.syncpundit.ml/amp/vulnversity-walkthrough/"><meta property="og:title" content="Vulnversity - Walkthrough, Sync_Pundit's Blog👽😎🔱🔥"><meta property="og:image" content="https://blog.syncpundit.ml/media/posts/3/vulversity-2.png"><meta property="og:site_name" content="Sync_Pundit's Blog👽😎🔱🔥"><meta property="og:description" content="Vulnversity - Walkthrough. Step by step guide on how to exploit Vulnversity on https://tryhackme.com/room/vulnversity"><meta property="og:url" content="https://blog.syncpundit.ml/vulnversity-walkthrough/"><meta property="og:type" content="article"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@Sync_Pundit"><meta name="twitter:title" content="Vulnversity - Walkthrough, Sync_Pundit's Blog👽😎🔱🔥"><meta name="twitter:description" content="Vulnversity - Walkthrough. Step by step guide on how to exploit Vulnversity on https://tryhackme.com/room/vulnversity"><meta name="twitter:image" content="https://blog.syncpundit.ml/media/posts/3/vulversity-2.png"><link rel="shortcut icon" href="https://blog.syncpundit.ml/media/website/favicon-crop.png" type="image/png"><style>:root{--primary-font:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";--secondary-font:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol"}</style><link rel="stylesheet" href="https://blog.syncpundit.ml/assets/css/fontawesome-all.min.css?v=dbf9d822cefe851ba6f66e1ad57e8987"><link rel="stylesheet" href="https://blog.syncpundit.ml/assets/css/style.css?v=e9216faac65d15461dfefa48fa99f923"><noscript><link rel="stylesheet" href="https://blog.syncpundit.ml/assets/css/noscript.css?v=6228c7eee614cd200a2cad8333b439fa"></noscript><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.syncpundit.ml/vulnversity-walkthrough/"},"headline":"Vulnversity - Walkthrough","datePublished":"2021-07-23T19:53","dateModified":"2021-07-23T23:39","image":{"@type":"ImageObject","url":"https://blog.syncpundit.ml/media/posts/3/vulversity-2.png","height":827,"width":1156},"description":"With the machine spun up and ready, let's get into it! We are looking open ports. My favorite and go-to tool for this&hellip;","author":{"@type":"Person","name":"Sync_Pundit"},"publisher":{"@type":"Organization","name":"Sync_Pundit"}}</script><style>#wrapper > .bg {
               background-image: url(https://blog.syncpundit.ml/assets/images/overlay.png), linear-gradient(0deg, rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0.1)), url(https://blog.syncpundit.ml/media/website/Background-2.png);
           }</style><meta name="author" content="Sync_Pundit 👽😎🔱🔥"><meta name="keywords" content="Sync_Pundit,👽😎🔱🔥, Deon Trevor Mpofu, Sync Pundit, syncpundit, Cyber Security Analyst"><meta name="description" content="Sync_Pundit 👽😎🔱🔥| Cyber Security Analyst| Taking down Phishing"><meta name="keywords" content="Sync_Pundit,👽😎🔱🔥, Deon Trevor Mpofu, Sync Pundit, syncpundit, Cyber Security Analyst, curious n00b"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="abuseipdb-verification" content="PE2zl36d"><meta name="google-site-verification" content="8NihvxbsfA4L8yxty8cAIgLP38dLuHOhT_ScNSrU00c"><link rel="dns-prefetch" href="https://y.at/👽😎🔱🔥"><link rel="prerender" href="https://y.at/👽😎🔱🔥"><link rel="preconnect" href="https://y.at/👽😎🔱🔥"><link rel="prerender" href="syncpundit.ml"><link rel="preconnect" href="syncpundit.ml"><link rel="dns-prefetch" href="syncpundit.ml/"><link rel="dns-prefetch" href="blog.syncpundit.ml/"><link rel="prerender" href="blog.syncpundit.ml"><link rel="preconnect" href="blog.syncpundit.ml"><link rel="apple-touch-icon" sizes="180x180" href="/media/website/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/media/website/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/media/website/favicon-16x16.png"><link rel="manifest" href="/media/website/site.webmanifest"><script async src="https://www.googletagmanager.com/gtag/js?id=G-F67QT1PGXR"></script><script>window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-F67QT1PGXR');</script><script src="https://cdn.jsdelivr.net/npm/@widgetbot/crate@3" async defer="defer">new Crate({
    server: '741328290996027454', // Sync_Pundit
    channel: '747563756732678175' // #hack_things
  })</script><script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="Sync_Pundit" data-description="Support me on Buy me a coffee!" data-message="Buy me a pizza😅" data-color="#79D6B5" data-position="left" data-x_margin="22" data-y_margin="22"></script></head><body class="is-preload"><script src="/__/firebase/8.3.0/firebase-app.js"></script><script src="/__/firebase/8.3.0/firebase-analytics.js"></script><script src="/__/firebase/init.js"></script><div id="wrapper"><header id="header"><a class="logo" href="https://blog.syncpundit.ml/">Sync_Pundit&#x27;s Blog👽😎🔱🔥</a></header><nav id="nav"><ul class="links"><li class="Research"><a href="https://blog.syncpundit.ml/sync/research/" title="Research" target="_self">Research</a></li><li class="Walkthroughs"><a href="https://blog.syncpundit.ml/sync/walkthroughs/" title="Walkthroughs" target="_self">Walkthroughs</a></li></ul><ul class="icons"><li><a href="https://twitter.com/Sync_Pundit" class="icon brands fa-twitter"><span class="label">Twitter</span></a></li><li><a href="https://www.linkedin.com/in/deon-trevor-mpofu/" class="icon brands fa-linkedin"><span class="label">LinkedIn</span></a></li></ul></nav><main id="main"><article class="post"><header class="major"><time datetime="2021-07-23T19:53" class="date">Friday, July 23, 2021</time><h1>Vulnversity - Walkthrough</h1><p class="post__inner">Let&#x27;s pawn https://tryhackme.com/room/vulnversity together!</p></header><figure class="image main"><img src="https://blog.syncpundit.ml/media/posts/3/vulversity-2.png" srcset="https://blog.syncpundit.ml/media/posts/3/responsive/vulversity-2-xs.png 300w, https://blog.syncpundit.ml/media/posts/3/responsive/vulversity-2-sm.png 480w, https://blog.syncpundit.ml/media/posts/3/responsive/vulversity-2-md.png 768w, https://blog.syncpundit.ml/media/posts/3/responsive/vulversity-2-lg.png 1024w, https://blog.syncpundit.ml/media/posts/3/responsive/vulversity-2-xl.png 1360w" sizes="(max-width: 1360px) 100vw, 1360px" loading="lazy" height="827" width="1156" alt="vulnversity home page"><figcaption>https://tryhackme.com/room/vulnversity</figcaption></figure><div class="post__inner post__entry"><figure class="post__image post__image--center"><img loading="lazy" src="https://blog.syncpundit.ml/media/posts/3/lets-go.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://blog.syncpundit.ml/media/posts/3/responsive/lets-go-xs.png 300w, https://blog.syncpundit.ml/media/posts/3/responsive/lets-go-sm.png 480w, https://blog.syncpundit.ml/media/posts/3/responsive/lets-go-md.png 768w, https://blog.syncpundit.ml/media/posts/3/responsive/lets-go-lg.png 1024w, https://blog.syncpundit.ml/media/posts/3/responsive/lets-go-xl.png 1360w, https://blog.syncpundit.ml/media/posts/3/responsive/lets-go-2xl.png 1600w" alt="Machine Information" width="1209" height="464"></figure><p>With the machine spun up and ready, let's get into it!</p><h2>Reconnaissance</h2><p>We are looking open ports. My favorite and go-to tool for this is NMAP. We'll scan using</p><blockquote><p>nmap -Pn -sS -sV -T4 10.10.238.250</p></blockquote><figure class="post__image post__image--center"><img loading="lazy" src="https://blog.syncpundit.ml/media/posts/3/nmap-out-2.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://blog.syncpundit.ml/media/posts/3/responsive/nmap-out-2-xs.png 300w, https://blog.syncpundit.ml/media/posts/3/responsive/nmap-out-2-sm.png 480w, https://blog.syncpundit.ml/media/posts/3/responsive/nmap-out-2-md.png 768w, https://blog.syncpundit.ml/media/posts/3/responsive/nmap-out-2-lg.png 1024w, https://blog.syncpundit.ml/media/posts/3/responsive/nmap-out-2-xl.png 1360w, https://blog.syncpundit.ml/media/posts/3/responsive/nmap-out-2-2xl.png 1600w" alt="Nmap Output" width="1141" height="390"></figure><p>There's an "Apache Server" running on port 3333. Opening 10.10.238.250:3333 in the browser takes us to a web application.</p><figure class="post__image post__image--center"><img loading="lazy" src="https://blog.syncpundit.ml/media/posts/3/vulversity.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://blog.syncpundit.ml/media/posts/3/responsive/vulversity-xs.png 300w, https://blog.syncpundit.ml/media/posts/3/responsive/vulversity-sm.png 480w, https://blog.syncpundit.ml/media/posts/3/responsive/vulversity-md.png 768w, https://blog.syncpundit.ml/media/posts/3/responsive/vulversity-lg.png 1024w, https://blog.syncpundit.ml/media/posts/3/responsive/vulversity-xl.png 1360w, https://blog.syncpundit.ml/media/posts/3/responsive/vulversity-2xl.png 1600w" alt="Vulnversity" width="1156" height="827"></figure><p>We'll look for directories and input fields, more-so uploads, for reverse shells of course! I'll be using gobuster for the job.</p><blockquote><p>gobuster dir -t 10 --wildcard  -e -r --url http://10.10.238.250:3333/ -w dirs.txt -a "Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:47.0) Gecko/20100101 Firefox/47.0"</p></blockquote><p>We found an interesting directory "/internal/"</p><figure class="post__image post__image--center"><img loading="lazy" src="https://blog.syncpundit.ml/media/posts/3/gobuster.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://blog.syncpundit.ml/media/posts/3/responsive/gobuster-xs.png 300w, https://blog.syncpundit.ml/media/posts/3/responsive/gobuster-sm.png 480w, https://blog.syncpundit.ml/media/posts/3/responsive/gobuster-md.png 768w, https://blog.syncpundit.ml/media/posts/3/responsive/gobuster-lg.png 1024w, https://blog.syncpundit.ml/media/posts/3/responsive/gobuster-xl.png 1360w, https://blog.syncpundit.ml/media/posts/3/responsive/gobuster-2xl.png 1600w" alt="gobuster output" width="891" height="348"></figure><p>Opening it leads us to... wait for it ......</p><figure class="post__image post__image--center"><img loading="lazy" src="https://blog.syncpundit.ml/media/posts/3/upload.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://blog.syncpundit.ml/media/posts/3/responsive/upload-xs.png 300w, https://blog.syncpundit.ml/media/posts/3/responsive/upload-sm.png 480w, https://blog.syncpundit.ml/media/posts/3/responsive/upload-md.png 768w, https://blog.syncpundit.ml/media/posts/3/responsive/upload-lg.png 1024w, https://blog.syncpundit.ml/media/posts/3/responsive/upload-xl.png 1360w, https://blog.syncpundit.ml/media/posts/3/responsive/upload-2xl.png 1600w" alt="" width="598" height="360"></figure>An upload 😌. For this one we'll go with a php reverse shell. i'll go ahead and grab it from<p></p><blockquote><p>/usr/share/webshells/php/php-reverse-shell.php</p></blockquote><p>After this we edit the IP and port and set them to our attack machine and a free port. </p><figure class="post__image post__image--center"><img loading="lazy" src="https://blog.syncpundit.ml/media/posts/3/php-rev-shell.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://blog.syncpundit.ml/media/posts/3/responsive/php-rev-shell-xs.png 300w, https://blog.syncpundit.ml/media/posts/3/responsive/php-rev-shell-sm.png 480w, https://blog.syncpundit.ml/media/posts/3/responsive/php-rev-shell-md.png 768w, https://blog.syncpundit.ml/media/posts/3/responsive/php-rev-shell-lg.png 1024w, https://blog.syncpundit.ml/media/posts/3/responsive/php-rev-shell-xl.png 1360w, https://blog.syncpundit.ml/media/posts/3/responsive/php-rev-shell-2xl.png 1600w" alt="" width="642" height="306"></figure><p>Now we start a NetCat listener on port 6996 with</p><blockquote><p>nc -lnvp 6996</p></blockquote><p>A lot of uploads either filter out or expect specific filetypes so we'd have to make a bunch of copies of the reverse shell and rename each with a different extension, to test which ones work. I'm lazy, so I'll use BurpSuite instead. I'll use</p><blockquote><p>http://10.10.238.250:3333/internal/</p></blockquote><p>as the scope.</p><figure class="post__image post__image--center"><img loading="lazy" src="https://blog.syncpundit.ml/media/posts/3/scope.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://blog.syncpundit.ml/media/posts/3/responsive/scope-xs.png 300w, https://blog.syncpundit.ml/media/posts/3/responsive/scope-sm.png 480w, https://blog.syncpundit.ml/media/posts/3/responsive/scope-md.png 768w, https://blog.syncpundit.ml/media/posts/3/responsive/scope-lg.png 1024w, https://blog.syncpundit.ml/media/posts/3/responsive/scope-xl.png 1360w, https://blog.syncpundit.ml/media/posts/3/responsive/scope-2xl.png 1600w" alt="scope" width="614" height="198"></figure>We'll use the intruder to test the file types. Leave interceptor on and open the inbuilt browser. Paste the url and load the page. Go back and turn the interceptor off. Try to upload the reverse shell. <p></p><figure class="post__image post__image--center"><img loading="lazy" src="https://blog.syncpundit.ml/media/posts/3/upload-rejected.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://blog.syncpundit.ml/media/posts/3/responsive/upload-rejected-xs.png 300w, https://blog.syncpundit.ml/media/posts/3/responsive/upload-rejected-sm.png 480w, https://blog.syncpundit.ml/media/posts/3/responsive/upload-rejected-md.png 768w, https://blog.syncpundit.ml/media/posts/3/responsive/upload-rejected-lg.png 1024w, https://blog.syncpundit.ml/media/posts/3/responsive/upload-rejected-xl.png 1360w, https://blog.syncpundit.ml/media/posts/3/responsive/upload-rejected-2xl.png 1600w" alt="upload rejected" width="574" height="323"></figure>Head over to the HTTP history and find the POST request.<p></p><figure class="post__image post__image--center"><img loading="lazy" src="https://blog.syncpundit.ml/media/posts/3/http-history.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://blog.syncpundit.ml/media/posts/3/responsive/http-history-xs.png 300w, https://blog.syncpundit.ml/media/posts/3/responsive/http-history-sm.png 480w, https://blog.syncpundit.ml/media/posts/3/responsive/http-history-md.png 768w, https://blog.syncpundit.ml/media/posts/3/responsive/http-history-lg.png 1024w, https://blog.syncpundit.ml/media/posts/3/responsive/http-history-xl.png 1360w, https://blog.syncpundit.ml/media/posts/3/responsive/http-history-2xl.png 1600w" alt="http history" width="706" height="321"></figure>Send it to the intruder with CTRL+i. Clear the selected positions.<p></p><figure class="post__image post__image--center"><img loading="lazy" src="https://blog.syncpundit.ml/media/posts/3/clear.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://blog.syncpundit.ml/media/posts/3/responsive/clear-xs.png 300w, https://blog.syncpundit.ml/media/posts/3/responsive/clear-sm.png 480w, https://blog.syncpundit.ml/media/posts/3/responsive/clear-md.png 768w, https://blog.syncpundit.ml/media/posts/3/responsive/clear-lg.png 1024w, https://blog.syncpundit.ml/media/posts/3/responsive/clear-xl.png 1360w, https://blog.syncpundit.ml/media/posts/3/responsive/clear-2xl.png 1600w" alt="clear positions" width="279" height="318"></figure>Highlight the filename and add the position<p></p><figure class="post__image post__image--center"><img loading="lazy" src="https://blog.syncpundit.ml/media/posts/3/filename.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://blog.syncpundit.ml/media/posts/3/responsive/filename-xs.png 300w, https://blog.syncpundit.ml/media/posts/3/responsive/filename-sm.png 480w, https://blog.syncpundit.ml/media/posts/3/responsive/filename-md.png 768w, https://blog.syncpundit.ml/media/posts/3/responsive/filename-lg.png 1024w, https://blog.syncpundit.ml/media/posts/3/responsive/filename-xl.png 1360w, https://blog.syncpundit.ml/media/posts/3/responsive/filename-2xl.png 1600w" alt="highligh new position" width="282" height="110"></figure><p>Head over to the payload section and add some extensions to the simple list payload option. We'll be trying</p><ul><li>html</li><li>php1</li><li>php2</li><li>php5</li><li>phtml</li></ul><figure class="post__image post__image--center"><img loading="lazy" src="https://blog.syncpundit.ml/media/posts/3/payload-list.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://blog.syncpundit.ml/media/posts/3/responsive/payload-list-xs.png 300w, https://blog.syncpundit.ml/media/posts/3/responsive/payload-list-sm.png 480w, https://blog.syncpundit.ml/media/posts/3/responsive/payload-list-md.png 768w, https://blog.syncpundit.ml/media/posts/3/responsive/payload-list-lg.png 1024w, https://blog.syncpundit.ml/media/posts/3/responsive/payload-list-xl.png 1360w, https://blog.syncpundit.ml/media/posts/3/responsive/payload-list-2xl.png 1600w" alt="payload list" width="583" height="316"></figure><p>Finally disable URL-encode and start the attack! Results from the intruder always look identical, so we search for the one that's different from the rest. If it exists, it's our winner!</p><figure class="post__image post__image--center"><img loading="lazy" src="https://blog.syncpundit.ml/media/posts/3/compromise.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://blog.syncpundit.ml/media/posts/3/responsive/compromise-xs.png 300w, https://blog.syncpundit.ml/media/posts/3/responsive/compromise-sm.png 480w, https://blog.syncpundit.ml/media/posts/3/responsive/compromise-md.png 768w, https://blog.syncpundit.ml/media/posts/3/responsive/compromise-lg.png 1024w, https://blog.syncpundit.ml/media/posts/3/responsive/compromise-xl.png 1360w, https://blog.syncpundit.ml/media/posts/3/responsive/compromise-2xl.png 1600w" alt="access gained" width="682" height="247"></figure><p>".phtml" seems to have worked. Lets navigate to the "/uploads/" directory to confirm</p><figure class="post__image post__image--center"><img loading="lazy" src="https://blog.syncpundit.ml/media/posts/3/we-in.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://blog.syncpundit.ml/media/posts/3/responsive/we-in-xs.png 300w, https://blog.syncpundit.ml/media/posts/3/responsive/we-in-sm.png 480w, https://blog.syncpundit.ml/media/posts/3/responsive/we-in-md.png 768w, https://blog.syncpundit.ml/media/posts/3/responsive/we-in-lg.png 1024w, https://blog.syncpundit.ml/media/posts/3/responsive/we-in-xl.png 1360w, https://blog.syncpundit.ml/media/posts/3/responsive/we-in-2xl.png 1600w" alt="proof of compromise" width="484" height="231"></figure>Now that we have proof of compromise we can go ahead and execute the reverse shell by opening it in the browser.<p></p><h2>Initial Access</h2><figure class="post__image post__image--center"><img loading="lazy" src="https://blog.syncpundit.ml/media/posts/3/initial-access.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://blog.syncpundit.ml/media/posts/3/responsive/initial-access-xs.png 300w, https://blog.syncpundit.ml/media/posts/3/responsive/initial-access-sm.png 480w, https://blog.syncpundit.ml/media/posts/3/responsive/initial-access-md.png 768w, https://blog.syncpundit.ml/media/posts/3/responsive/initial-access-lg.png 1024w, https://blog.syncpundit.ml/media/posts/3/responsive/initial-access-xl.png 1360w, https://blog.syncpundit.ml/media/posts/3/responsive/initial-access-2xl.png 1600w" alt="initial access" width="1440" height="207"></figure><p>We're in! We do some basic prying to see who we are in the system, who are the other users and what are their privileges?</p><figure class="post__image post__image--center"><img loading="lazy" src="https://blog.syncpundit.ml/media/posts/3/user-flag.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://blog.syncpundit.ml/media/posts/3/responsive/user-flag-xs.png 300w, https://blog.syncpundit.ml/media/posts/3/responsive/user-flag-sm.png 480w, https://blog.syncpundit.ml/media/posts/3/responsive/user-flag-md.png 768w, https://blog.syncpundit.ml/media/posts/3/responsive/user-flag-lg.png 1024w, https://blog.syncpundit.ml/media/posts/3/responsive/user-flag-xl.png 1360w, https://blog.syncpundit.ml/media/posts/3/responsive/user-flag-2xl.png 1600w" alt="user flag" width="728" height="262"></figure><p>And we have our user flag! With that let's checkout some SUID binaries. </p><h2>Privilege Escalation</h2><figure class="post__image post__image--center"><img loading="lazy" src="https://blog.syncpundit.ml/media/posts/3/suid.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://blog.syncpundit.ml/media/posts/3/responsive/suid-xs.png 300w, https://blog.syncpundit.ml/media/posts/3/responsive/suid-sm.png 480w, https://blog.syncpundit.ml/media/posts/3/responsive/suid-md.png 768w, https://blog.syncpundit.ml/media/posts/3/responsive/suid-lg.png 1024w, https://blog.syncpundit.ml/media/posts/3/responsive/suid-xl.png 1360w, https://blog.syncpundit.ml/media/posts/3/responsive/suid-2xl.png 1600w" alt="SUID" width="661" height="678"></figure><p>We have a bunch of interesting stuff to use to our advantage but first lets spawn a TTY shell to get rid of some restrictions.</p><blockquote><p>python -c 'import pty; pty.spawn("/bin/bash")'</p></blockquote><p>In case you were wondering, i haven't memorised all these commands yet. I use <a href="https://github.com/LasCC/Hack-Tools" target="_blank" rel="noopener noreferrer">Hack Tools</a>, check them out and buy them a coffee! Remember one of the binaries we found was </p><blockquote><p>/bin/systemctl</p></blockquote><p>It's especially interesting because systemctl controls service managers. This means that we can mess around with <strong>/etc/system/systemd. </strong>I'll navigate to the /opt directory and we'll create some environment variables from there.</p><blockquote><p>priv=$(mktemp).service</p></blockquote><p>Next we attach a unit file to our environment variable</p><figure class="post__image post__image--center"><img loading="lazy" src="https://blog.syncpundit.ml/media/posts/3/service.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://blog.syncpundit.ml/media/posts/3/responsive/service-xs.png 300w, https://blog.syncpundit.ml/media/posts/3/responsive/service-sm.png 480w, https://blog.syncpundit.ml/media/posts/3/responsive/service-md.png 768w, https://blog.syncpundit.ml/media/posts/3/responsive/service-lg.png 1024w, https://blog.syncpundit.ml/media/posts/3/responsive/service-xl.png 1360w, https://blog.syncpundit.ml/media/posts/3/responsive/service-2xl.png 1600w" alt="service" width="742" height="184"></figure><p>With that we just created a simple service that executes the "cat" command on the root flag and writes it in the /opt directory we're in. Since the user flag was in a file called user.txt, my bet is that the root flag is called root.txt. When the service runs successfully the flag should be saved as "root-flag" in the /opt directory.</p><p>Let's run the unit file using /bin/systemctl</p><blockquote><p>/bin/systemctl link $priv</p><p>/bin/systemctl enable --now $priv</p></blockquote><figure class="post__image post__image--center"><img loading="lazy" src="https://blog.syncpundit.ml/media/posts/3/root-flag.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://blog.syncpundit.ml/media/posts/3/responsive/root-flag-xs.png 300w, https://blog.syncpundit.ml/media/posts/3/responsive/root-flag-sm.png 480w, https://blog.syncpundit.ml/media/posts/3/responsive/root-flag-md.png 768w, https://blog.syncpundit.ml/media/posts/3/responsive/root-flag-lg.png 1024w, https://blog.syncpundit.ml/media/posts/3/responsive/root-flag-xl.png 1360w, https://blog.syncpundit.ml/media/posts/3/responsive/root-flag-2xl.png 1600w" alt="root flag" width="1446" height="182"></figure><p>And with that you can run whatever command with root privileges as a service. RPaaS🤓. Happy hacking!</p></div><footer class="post__inner post__footer"><p class="post__last-updated">This article was updated on Friday, July 23, 2021</p><div class="post__share-tag-container"><div class="post__tag"><h3>Tagged in:</h3><ul><li><a href="https://blog.syncpundit.ml/sync/walkthroughs/">Walkthroughs</a></li></ul></div><div class="post__share"><button class="post__share-button js-post__share-button icon" aria-label="Share button"><i class="fas fa-share-alt"></i></button><div class="post__share-popup js-post__share-popup"><a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fblog.syncpundit.ml%2Fvulnversity-walkthrough%2F" class="js-share icon brands fa-facebook-f" rel="nofollow noopener noreferrer"><span class="label">Facebook</span> </a><a href="https://twitter.com/share?url=https%3A%2F%2Fblog.syncpundit.ml%2Fvulnversity-walkthrough%2F&amp;via=%40Sync_Pundit&amp;text=Vulnversity%20-%20Walkthrough" class="js-share icon brands fa-twitter" rel="nofollow noopener noreferrer"><span class="label">Twitter</span> </a><a href="https://pinterest.com/pin/create/button/?url=https%3A%2F%2Fblog.syncpundit.ml%2Fvulnversity-walkthrough%2F&amp;media=https%3A%2F%2Fblog.syncpundit.ml%2Fmedia%2Fposts%2F3%2Fvulversity-2.png&amp;description=Vulnversity%20-%20Walkthrough" class="js-share icon brands fa-pinterest" rel="nofollow noopener noreferrer"><span class="label">Pinterest</span> </a><a href="https://mix.com/add?url=https%3A%2F%2Fblog.syncpundit.ml%2Fvulnversity-walkthrough%2F" class="js-share icon brands fa-mix" rel="nofollow noopener noreferrer"><span class="label">Mix</span> </a><a href="https://www.linkedin.com/shareArticle?url=https%3A%2F%2Fblog.syncpundit.ml%2Fvulnversity-walkthrough%2F&amp;title=Vulnversity%20-%20Walkthrough" class="js-share icon brands fa-linkedin" rel="nofollow noopener noreferrer"><span class="label">LinkedIn</span> </a><a href="https://api.whatsapp.com/send?text=Vulnversity%20-%20Walkthrough https%3A%2F%2Fblog.syncpundit.ml%2Fvulnversity-walkthrough%2F" class="js-share icon brands fa-whatsapp" rel="nofollow noopener noreferrer"><span class="label">WhatsApp</span></a></div></div></div><div class="post__bio"><img src="https://blog.syncpundit.ml/media/website/favicon-crop.jpg" loading="lazy" alt="Sync_Pundit"><div><h3><a href="https://blog.syncpundit.ml/authors/sync_pundit/" class="invert" rel="author">Sync_Pundit</a></h3><p>Curious n00b | Follow me and I will make you Phishers of man</p></div></div></footer></article><div class="comments"><div class="post__inner"><h2>Comments</h2><div id="disqus_thread"></div><script>var disqus_config = function () {
                       this.page.url = 'https://blog.syncpundit.ml/vulnversity-walkthrough/';
               		this.page.identifier = '3';
                   };
               
                   var disqus_loaded = false;
               
                   function publiiLoadDisqus() {
                       if(disqus_loaded) {
                           return false;
                       }
               
                       var top = document.getElementById('disqus_thread').offsetTop;
               
                       if (!disqus_loaded && (window.scrollY || window.pageYOffset) + window.innerHeight > top) {
                           disqus_loaded = true;
               
                           (function () {
                               var d = document, s = d.createElement('script');
                               s.src = 'https://'+'sync_pundit'.trim()+'.disqus.com/embed.js';
                               s.setAttribute('data-timestamp', +new Date());
                               (d.head || d.body).appendChild(s);
                           })();
                       }
                   }
               
                   publiiLoadDisqus();
               
                   window.onscroll = function() {
                       publiiLoadDisqus();
                   };</script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" target="_blank" rel="nofollow noopener noreferrer">comments powered by Disqus.</a></noscript></div></div></main><footer id="copyright"><ul><li>© Sync_Pundit</li><li><a href="https://html5up.net" target="_blank" rel="nofollow noopener"></a>/usr/bin/Sync_Pundit</li><li>curious n00b</li></ul></footer></div><script src="https://blog.syncpundit.ml/assets/js/jquery.min.js?v=7c14a783dfeb3d238ccd3edd840d82ee"></script><script src="https://blog.syncpundit.ml/assets/js/jquery.scrollex.min.js?v=f89065e3d988006af9791b44561d7c90"></script><script src="https://blog.syncpundit.ml/assets/js/jquery.scrolly.min.js?v=1ed5a78bde1476875a40f6b9ff44fc14"></script><script src="https://blog.syncpundit.ml/assets/js/browser.min.js?v=c07298dd19048a8a69ad97e754dfe8d0"></script><script src="https://blog.syncpundit.ml/assets/js/breakpoints.min.js?v=81a479eb099e3b187613943b085923b8"></script><script src="https://blog.syncpundit.ml/assets/js/util.min.js?v=4201a626f8c9b614a663b3a1d7d82615"></script><script src="https://blog.syncpundit.ml/assets/js/main.min.js?v=149e72e3ae18744a477b480b19e0c6da"></script><script>/*<![CDATA[*/var images=document.querySelectorAll("img[loading]");for(var i=0;i<images.length;i++){if(images[i].complete){images[i].classList.add("is-loaded")}else{images[i].addEventListener("load",function(){this.classList.add("is-loaded")},false)}};/*]]>*/</script></body></html>